const debug = require('../');
var a = require('debug')('worker:a')
  , b = require('debug')('worker:b');

const fs = require('fs');
const path = require('path');
const filePath = path.resolve(__dirname, 'out.file');

debug.getState().setConfigs({
  debug: 'worker:*',
  useColors: true,        // false
  toFile: path.resolve(__dirname, 'out.file')
});


function work() {
  a('doing lots of uninteresting work');
  setTimeout(work, Math.random() * 1000);
}

work();

function workb() {
  b('doing some work');
  setTimeout(workb, Math.random() * 2000);
}

workb();

setTimeout(function(){
  b(new Error('fail'));
}, 5000);

fs.createReadStream(path.resolve(__dirname, 'log-to-file.js')).pipe(a.writer);